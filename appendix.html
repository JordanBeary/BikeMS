<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Additional Code Not Shown in Final Report</title>

<script src="site_libs/jquery/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap/shim/respond.min.js"></script>
<script src="site_libs/navigation/tabsets.js"></script>
<link href="site_libs/highlightjs/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TUN Data Challenge 2018</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Final Report</a>
</li>
<li>
  <a href="appendix.html">Appendix</a>
</li>
<li>
  <a href="ProgressLog.html">Progress Log</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Additional Code Not Shown in Final Report</h1>

</div>


<p>Loading libraries:</p>
<pre><code>library(readr)
library(plyr)
library(tidyr)
library(lubridate)
library(tidyverse)
library(dplyr)
library(ggplot2)
</code></pre>
<p>#Cleaning NMSS Data</p>
<div id="konrad-ramya-cleaning-donations-data-for-2013-2017" class="section level2">
<h2>Konrad &amp; Ramya: Cleaning donations data for 2013-2017:</h2>
<p>Reading in the data:</p>
<pre><code>donations2013 &lt;- read_csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Donations\\2013 Bike Donations Date Fixed.csv&quot;)
donations2014 &lt;- read_csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Donations\\2014 Bike Donations Date Fixed.csv&quot;)
donations2015 &lt;- read_csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Donations\\2015 Bike Donations Date Fixed.csv&quot;)
donations2016 &lt;- read_csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Donations\\2016 Bike Donations Date Fixed.csv&quot;)
donations2017 &lt;- read_csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Donations\\2017 Bike Donations Date Fixed.csv&quot;)
</code></pre>
<p>Comparing column names to make sure the data is in the right order and all fields are the same:</p>
<pre><code>cols2013 &lt;- colnames(donations2013)
cols2014 &lt;- colnames(donations2014)
cols2015 &lt;- colnames(donations2015)
cols2016 &lt;- colnames(donations2016)
cols2017 &lt;- colnames(donations2017)


identical(cols2013, cols2014)
identical(cols2013, cols2015)
identical(cols2013, cols2016)
identical(cols2013, cols2017)


remove(cols2013, cols2014, cols2015, cols2016, cols2017)</code></pre>
<p>Changing some columns to factors:</p>
<pre><code>cols &lt;- c(1, 2, 3, 4, 6, 7, 10:19, 21:32, 35, 36, 38, 39, 44:49)
donations2013[,cols] &lt;- lapply(donations2013[,cols], factor)
donations2014[,cols] &lt;- lapply(donations2014[,cols], factor)
donations2015[,cols] &lt;- lapply(donations2015[,cols], factor)
donations2016[,cols] &lt;- lapply(donations2016[,cols], factor)
donations2017[,cols] &lt;- lapply(donations2017[,cols], factor)</code></pre>
<div id="refactoring-certain-columns" class="section level3">
<h3>Refactoring certain columns:</h3>
<div id="donor-gender" class="section level4">
<h4>Donor Gender:</h4>
<pre><code>#summary(donations2013$`Donor Gender`)
levels(donations2013$`Donor Gender`) &lt;- list(Female=c(&quot;Female&quot;, &quot;F&quot;, &quot;Feiale&quot;), Male=c(&quot;Male&quot;, &quot;M&quot;, &quot;Iale&quot;))
#summary(donations2013$`Donor Gender`)


#summary(donations2014$`Donor Gender`)
levels(donations2014$`Donor Gender`) &lt;- list(Female=c(&quot;Female&quot;, &quot;F&quot;, &quot;Feiale&quot;), Male=c(&quot;Male&quot;))
#summary(donations2014$`Donor Gender`)


#summary(donations2015$`Donor Gender`)
levels(donations2015$`Donor Gender`) &lt;- list(Female=c(&quot;Female&quot;, &quot;F&quot;, &quot;Femala&quot;), Male=c(&quot;Male&quot;))
#summary(donations2015$`Donor Gender`)


#summary(donations2016$`Donor Gender`)
levels(donations2016$`Donor Gender`) &lt;- list(Female=c(&quot;Female&quot;, &quot;F&quot;, &quot;Femala&quot;), Male=c(&quot;Male&quot;))
#summary(donations2016$`Donor Gender`)


#summary(donations2017$`Donor Gender`)
levels(donations2017$`Donor Gender`) &lt;- list(Female=c(&quot;Female&quot;, &quot;F&quot;, &quot;Femala&quot;, &quot;Famale&quot;), Male=c(&quot;Male&quot;, &quot;M&quot;))
#summary(donations2017$`Donor Gender`)
</code></pre>
</div>
</div>
<div id="prior-participants" class="section level3">
<h3>Prior participants:</h3>
<pre><code>#summary(donations2013$`Is Prior Participant`)
levels(donations2013$`Is Prior Participant`) &lt;- list(Yes = c(&quot;Yes&quot;))
#summary(donations2013$`Is Prior Participant`)


#summary(donations2014$`Is Prior Participant`)
levels(donations2014$`Is Prior Participant`) &lt;- list(Yes = &quot;Yes&quot;)
#summary(donations2014$`Is Prior Participant`)


#summary(donations2015$`Is Prior Participant`)
levels(donations2015$`Is Prior Participant`) &lt;- list(Yes = &quot;Yes&quot;)
#summary(donations2015$`Is Prior Participant`)


#summary(donations2016$`Is Prior Participant`)
levels(donations2016$`Is Prior Participant`) &lt;- list(Yes = &quot;Yes&quot;)
#summary(donations2016$`Is Prior Participant`)


#summary(donations2017$`Is Prior Participant`)
levels(donations2017$`Is Prior Participant`) &lt;- list(Yes = &quot;Yes&quot;)
#summary(donations2017$`Is Prior Participant`)
</code></pre>
</div>
<div id="is-team-captain" class="section level3">
<h3>Is Team Captain</h3>
<pre><code>#summary(donations2013$`Is Team Captain`)
levels(donations2013$`Is Team Captain`) &lt;- list(Yes =&quot;TRUE&quot;, No = &quot;FALSE&quot;)
#summary(donations2013$`Is Team Captain`)


#summary(donations2014$`Is Team Captain`)
levels(donations2014$`Is Team Captain`) &lt;- list(Yes = c(&quot;TRUE&quot;, &quot;PRUE&quot;), No = &quot;FALSE&quot;)
#summary(donations2014$`Is Team Captain`)


#summary(donations2015$`Is Team Captain`)
levels(donations2015$`Is Team Captain`) &lt;- list(Yes = &quot;TRUE&quot;, No = c(&quot;FALSE&quot;, &quot;BALSE&quot;))
#summary(donations2015$`Is Team Captain`)

#summary(donations2016$`Is Team Captain`)
levels(donations2016$`Is Team Captain`) &lt;- list(Yes = c(&quot;TRUE&quot;, &quot;PRUE&quot;), No = &quot;FALSE&quot;)
#summary(donations2016$`Is Team Captain`)

#summary(donations2017$`Is Team Captain`)
levels(donations2017$`Is Team Captain`) &lt;- list(Yes = c(&quot;TRUE&quot;), No = c(&quot;FALSE&quot;, &quot;BALSE&quot;, &quot;FALSA&quot;))
#summary(donations2017$`Is Team Captain`)
</code></pre>
</div>
<div id="gift-payment-method" class="section level3">
<h3>Gift Payment Method</h3>
<pre><code>#summary(donations2013$`Gift Payment Method`)
levels(donations2013$`Gift Payment Method`) &lt;- list(Cash = &quot;Cash&quot;, Check= &quot;Check&quot;, `Credit Card` = &quot;Credit Card&quot;)
#summary(donations2013$`Gift Payment Method`)


#summary(donations2014$`Gift Payment Method`)
levels(donations2014$`Gift Payment Method`) &lt;- list(Cash = &quot;Cash&quot;, Check= &quot;Check&quot;, `Credit Card` = &quot;Credit Card&quot;)
#summary(donations2014$`Gift Payment Method`)


#summary(donations2015$`Gift Payment Method`)
# No NAs or anything to refactor

#summary(donations2016$`Gift Payment Method`)
levels(donations2016$`Gift Payment Method`) &lt;- list(Cash = &quot;Cash&quot;, Check= &quot;Check&quot;, `Credit Card` = c(&quot;Credit Card&quot;, &quot;Credit Car&quot;))
#summary(donations2016$`Gift Payment Method`)


#summary(donations2017$`Gift Payment Method`)
levels(donations2017$`Gift Payment Method`) &lt;- list(Cash = &quot;Cash&quot;, Check= &quot;Check&quot;, `Credit Card` = c(&quot;Credit Card&quot;, &quot;Credit Car&quot;))
#summary(donations2017$`Gift Payment Method`)

</code></pre>
</div>
<div id="gift-type" class="section level3">
<h3>Gift Type</h3>
<pre><code>#summary(donations2013$`Gift Type`)
levels(donations2013$`Gift Type`) &lt;- list(Offline=c(&quot;offline&quot;, &quot;ofbline&quot;), Online=&quot;online&quot;)
#summary(donations2013$`Gift Type`)


#summary(donations2014$`Gift Type`)
levels(donations2014$`Gift Type`) &lt;- list(Offline=&quot;offline&quot;, Online=c(&quot;online&quot;, &quot;ojline&quot;))
#summary(donations2014$`Gift Type`)


#summary(donations2015$`Gift Type`)
levels(donations2015$`Gift Type`) &lt;- list(Offline=&quot;offline&quot;, Online=&quot;online&quot;)
#summary(donations2015$`Gift Type`)


#summary(donations2016$`Gift Type`)
levels(donations2016$`Gift Type`) &lt;- list(Offline=&quot;offline&quot;, Online=c(&quot;online&quot;, &quot;onhine&quot;, &quot;onlina&quot;))
#summary(donations2016$`Gift Type`)
             

#summary(donations2017$`Gift Type`)
levels(donations2017$`Gift Type`) &lt;- list(Offline=&quot;offline&quot;, Online=c(&quot;online&quot;, &quot;ojline&quot;, &quot;onlina&quot;))
#summary(donations2017$`Gift Type`)
</code></pre>
</div>
<div id="offline-status" class="section level3">
<h3>Offline status</h3>
<pre><code>summary(donations2013$`Offline Status`)
summary(donations2014$`Offline Status`)
summary(donations2015$`Offline Status`)
summary(donations2016$`Offline Status`)
levels(donations2016$`Offline Status`)&lt;- list(confirmed = c(&quot;confirmed&quot;, &quot;confirme`&quot;), `Teamraiser Participant Gift` = c(&quot;(Teamraiser Participant Gift&quot;, &quot;Teamraiser Participant Gift&quot;))
summary(donations2017$`Offline Status`)</code></pre>
</div>
<div id="dealing-with-dates" class="section level3">
<h3>Dealing with dates</h3>
<ul>
<li>Date format was changed in Excel * to eg 08/12/13 to enable easy conversion of dates.</li>
</ul>
<pre><code>#Since each dataset is the same, can identify all date fields from just 2013 data
date_cols &lt;- which(names(donations2013)%in%c(&quot;Event Date&quot;, &quot;Date Recorded&quot;, &quot;Donor Opt-out Date&quot;, &quot;Registration Date&quot;, &quot;Team Creation Date&quot;))

donations2013[, date_cols] &lt;- lapply(donations2013[, date_cols], as.Date, &quot;%m/%d/%y&quot;)
donations2014[, date_cols] &lt;- lapply(donations2014[, date_cols], as.Date, &quot;%m/%d/%y&quot;)
donations2015[, date_cols] &lt;- lapply(donations2015[, date_cols], as.Date, &quot;%m/%d/%y&quot;)
donations2016[, date_cols] &lt;- lapply(donations2016[, date_cols], as.Date, &quot;%m/%d/%y&quot;)
donations2017[, date_cols] &lt;- lapply(donations2017[, date_cols], as.Date, &quot;%m/%d/%y&quot;)</code></pre>
</div>
<div id="writing-out-formatted-donations-data-to-an-rds-file" class="section level3">
<h3>Writing out Formatted Donations Data to an RDS file</h3>
<pre><code>saveRDS(donations2013, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2013.rds&quot;)
saveRDS(donations2014, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2014.rds&quot;)
saveRDS(donations2015, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2015.rds&quot;)
saveRDS(donations2016, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2016.rds&quot;)
saveRDS(donations2017, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2017.rds&quot;)

</code></pre>
</div>
</div>
<div id="konrad-cleaning-bike-teams-data" class="section level2">
<h2>Konrad: Cleaning Bike Teams Data</h2>
<pre><code>teams &lt;- read_csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Bike Teams\\2013-2017 Bike Teams Date Format Fixed.csv&quot;)</code></pre>
<pre><code>#summary(teams)
factor_cols &lt;- c(1:5, 7, 8, 10, 11, 20:22, 26)
teams[ ,factor_cols] &lt;- lapply(teams[ ,factor_cols], factor)

# Removed time from team creation date and Event Date (in Excel)!!! 

teams$`Team Creation Date` &lt;- as.Date(teams$`Team Creation Date`, format = &#39;%m/%d/%y&#39;)
teams$`Event Date` &lt;- as.Date(teams$`Event Date`, format = &#39;%m/%d/%y&#39;)

summary(teams$`Team Division`)

levels(teams$`Team Division`) &lt;- list(Association = &quot;Association&quot;, Brewery=&quot;Beer/Brewery&quot;, `Bike Club`=&quot;Bike Club&quot;, `Bike Shop` = c(&quot;Bike Shop&quot;, &quot;Bike Shops&quot;), `Civic Team` = &quot;Civic Team&quot;, `Club/Organization` = &quot;Club/Organization&quot;, Corporate = c(&quot;Corporate&quot;, &quot;Corporation&quot;), `Family/Friends` = c(&quot;Family and Friends&quot;, &quot;Family/Friends&quot;, &quot;Frien`s and Family&quot;, &quot;Friend and Family&quot;, &quot;Friends and Family&quot;), Ohana = &quot;Ohana&quot;, `Ohana/Friends` = &quot;Ohana and Friends&quot;, Open = &quot;Open&quot;, `Open Team` = &quot;Open Team&quot;, Organization = c(&quot;Organization&quot;, &quot;Organization (Clubs, Civic Groups, etc.)&quot;, &quot;Organization (Clubs; Civic Groups; etc.)&quot;, &quot;Organization (Clubs; Civic Groups; Place of Worship; etc.)&quot;), Other = &quot;Other&quot;, `Place of Worship` = c(&quot;Place of Worship&quot;, &quot;Place of worship&quot;, &quot;Religious&quot;), School = &quot;School&quot;, `Small Business` = &quot;Small Business&quot;, `Volunteer Group` = &quot;Volunteer Group&quot;)
</code></pre>
<pre><code>#summary(teams$`Event Type`)
#summary(teams$`Internal Event Name`)
#summary(teams$`Event ID`)
#summary(teams$`Team Creation Date`)

#summary(teams$`Captain Email Domain`)
#summary(teams$Company)
#summary(teams$`Team Name`)
#summary(teams$`Number of Participants`)</code></pre>
<pre><code>saveRDS(teams, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Bike Teams/teams.rds&quot;)</code></pre>
</div>
<div id="ramya-cleaning-bike-events" class="section level2">
<h2>Ramya: Cleaning Bike Events</h2>
<pre><code>BikeEvents&lt;-read.csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Events\\2013-2017 Bike Events.csv&quot;)</code></pre>
<pre><code>str(BikeEvents)</code></pre>
<pre><code>levels(BikeEvents$City)</code></pre>
<pre><code>#Cleaning cities
BikeEvents$City[BikeEvents$City == &#39;Athens, AL &#39;]&lt;- &quot;Athens&quot;

BikeEvents$City[BikeEvents$City == &#39;Cherry Hill, NJ with alternate start locations&#39;]&lt;-&quot;Cherry Hill&quot;
#as.factor(BikeEvents$City[BikeEvents$City == &#39;Ridgeland, MS&#39;]&lt;- &quot;Ridgeland&quot;)

BikeEvents$City[BikeEvents$City == &#39;St. Augustine &#39;]&lt;-&quot;St. Augustine&quot;

BikeEvents$City[BikeEvents$City == &#39;Sioux Falls area&#39;]&lt;-&quot;Sioux Falls&quot;

BikeEvents$City[BikeEvents$City == &#39;Schodack &#39;]&lt;-&quot;Schodack&quot;

BikeEvents$City[BikeEvents$City == &#39;San Antonio &#39;]&lt;-&quot;San Antonio&quot;

BikeEvents$City[BikeEvents$City == &#39;New York City&#39;]&lt;-&quot;New York&quot; 

BikeEvents$City[BikeEvents$City == &#39;New Albany &#39;]&lt;-&quot;New Albany&quot;

BikeEvents$City[BikeEvents$City == &#39;Keuka Park &#39;]&lt;-&quot;Keuka Park&quot;
BikeEvents$City[BikeEvents$City == &#39;Hollidaysburg, PA to State College&#39;]&lt;-&quot;Hollidaysburg&quot; 
BikeEvents$City[BikeEvents$City == &#39;Duluth to White Bear Lake&#39;]&lt;-&quot;Duluth&quot;
BikeEvents$City[BikeEvents$City == &#39;Duluth to the Twin Cities&#39;]&lt;-&quot;Duluth&quot;
BikeEvents$City[BikeEvents$City == &#39;Fargo area&#39;]&lt;-&quot;Fargo&quot;
BikeEvents$City[BikeEvents$City == &#39;Dallas &#39;]&lt;-&quot;Dallas&quot;
BikeEvents$City[BikeEvents$City == &#39;DeKalb&#39;]&lt;-&quot;Dekalb&quot;
BikeEvents$City[BikeEvents$City == &#39;DeKalb &#39;]&lt;-&quot;Dekalb&quot;
</code></pre>
<pre><code>summary(BikeEvents$Event.Date)</code></pre>
<pre><code>#Date Conversion in R
datecols_bikeevents&lt;-which(names(BikeEvents)%in%c(&quot;Event.Created.Date&quot;, &quot;Event.Date&quot;))

for (i in datecols_bikeevents) {
  BikeEvents[,i] = as.Date(BikeEvents[,i], &#39;%m/%d/%y&#39;)
}
</code></pre>
</div>
<div id="saving-the-work" class="section level2">
<h2>Saving the work</h2>
<pre><code>saveRDS(BikeEvents, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Bike Events/Bike Events.rds&quot;)</code></pre>
</div>
<div id="jordan-cleaning-bike-participants" class="section level2">
<h2>Jordan: Cleaning Bike Participants</h2>
<div id="import-data" class="section level3">
<h3>Import data</h3>
<pre><code>participants &lt;- read_csv(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Participants\\2013-2017 Bike MS Participants.csv&quot;)</code></pre>
</div>
<div id="basic-data-exploration" class="section level3">
<h3>Basic data exploration</h3>
<pre><code>class(participants)
dim(participants)
glimpse(participants)
head(participants, n = 5)
tail(participants, n = 5)
summary(participants)</code></pre>
<p>Able to see that some fields need to be converted from integers to characters. Also, easily able to identify which fields will need to be rid of NA values.</p>
<pre><code># need to change fields from int to char 
participants$`Team ID` &lt;- as.character(participants$`Team ID`)
class(participants$`Team ID`)
participants$`Contact ID` &lt;- as.character(participants$`Contact ID`)
participants$`Address -  Participant ZIP/Postal Code` &lt;- as.character(participants$`Address -  Participant ZIP/Postal Code`)
participants$`Event ID` &lt;- as.character(participants$`Event ID`)
summary(participants)

#change event date from character to date-time
participants$`Event Date` &lt;- mdy_hm(participants$`Event Date`)
class(participants$`Event Date`)
head(participants$`Event Date`, n = 5)</code></pre>
<pre><code># acknowledge NA&#39;s 
map(participants, ~sum(is.na(.)))</code></pre>
</div>
</div>
<div id="writing-out-jordans-work" class="section level2">
<h2>Writing out Jordan’s work</h2>
<pre><code>saveRDS(participants, &quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Participants/Participants.rds&quot;)</code></pre>
<pre><code>library(readr)
library(dplyr)
library(ggplot2)

donations2013 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2013.rds&quot;)
donations2014 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2014.rds&quot;)
donations2015 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2015.rds&quot;)
donations2016 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2016.rds&quot;)
donations2017 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2017.rds&quot;)

participants &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Participants/Participants.rds&quot;)

str(participants)
</code></pre>
</div>
<div id="creating-data-aggregations" class="section level1">
<h1>Creating Data Aggregations</h1>
<div id="from-donations-data" class="section level2">
<h2>From donations data</h2>
<pre><code>gen_2013 &lt;- summary(donations2013$`Donor Gender`)
gen_2014 &lt;- summary(donations2014$`Donor Gender`)
gen_2015 &lt;- summary(donations2015$`Donor Gender`)
gen_2016 &lt;- summary(donations2016$`Donor Gender`)
gen_2017 &lt;- summary(donations2017$`Donor Gender`)


gender_year &lt;- tibble(c(2013, 2014, 2015, 2016, 2017), 
                          c(gen_2013[1], gen_2014[1], gen_2015[1], gen_2016[1], gen_2017[1]), 
                          c(gen_2013[2], gen_2014[2], gen_2015[2], gen_2016[2], gen_2017[2]), 
                          c(gen_2013[3], gen_2014[3], gen_2015[3], gen_2016[3], gen_2017[3]))
                          
colnames(gender_year) &lt;- c(&quot;Year&quot;, &quot;Female&quot;, &quot;Male&quot;, &quot;NA&quot;)


year_num &lt;- tibble(2013:2017, c(nrow(donations2013), nrow(donations2014), nrow(donations2015), nrow(donations2016), nrow(donations2017)))
colnames(year_num) &lt;- c(&quot;Year&quot;, &quot;Number of Participants&quot;)


tot_gifts2013 &lt;- sum(donations2013$`Gift Amount($)`, na.rm = TRUE)
tot_gifts2014 &lt;- sum(donations2014$`Gift Amount($)`, na.rm = TRUE)
tot_gifts2015 &lt;- sum(donations2015$`Gift Amount($)`, na.rm = TRUE)
tot_gifts2016 &lt;- sum(donations2016$`Gift Amount($)`, na.rm = TRUE)
tot_gifts2017 &lt;- sum(donations2017$`Gift Amount($)`, na.rm = TRUE)

med_gifts2013 &lt;- median(donations2013$`Gift Amount($)`, na.rm = TRUE)
med_gifts2014 &lt;- median(donations2014$`Gift Amount($)`, na.rm = TRUE)
med_gifts2015 &lt;- median(donations2015$`Gift Amount($)`, na.rm = TRUE)
med_gifts2016 &lt;- median(donations2016$`Gift Amount($)`, na.rm = TRUE)
med_gifts2017 &lt;- median(donations2017$`Gift Amount($)`, na.rm = TRUE)

tot_donations &lt;- tibble(2013:2017,
                            c(tot_gifts2013, tot_gifts2014, tot_gifts2015, tot_gifts2016, tot_gifts2017),
                            c(med_gifts2013, med_gifts2014, med_gifts2015, med_gifts2016, med_gifts2017))

colnames(tot_donations) &lt;- c(&quot;Year&quot;, &quot;Total Donations&quot;, &quot;Median&quot;)

add_tot_gifts2013 &lt;- sum(donations2013$`Additional Gift Amount($)`, na.rm = TRUE)
add_tot_gifts2014 &lt;- sum(donations2014$`Additional Gift Amount($)`, na.rm = TRUE)
add_tot_gifts2015 &lt;- sum(donations2015$`Additional Gift Amount($)`, na.rm = TRUE)
add_tot_gifts2016 &lt;- sum(donations2016$`Additional Gift Amount($)`, na.rm = TRUE)
add_tot_gifts2017 &lt;- sum(donations2017$`Additional Gift Amount($)`, na.rm = TRUE)

add_med_gifts2013 &lt;- median(donations2013$`Additional Gift Amount($)`, na.rm = TRUE)
add_med_gifts2014 &lt;- median(donations2014$`Additional Gift Amount($)`, na.rm = TRUE)
add_med_gifts2015 &lt;- median(donations2015$`Additional Gift Amount($)`, na.rm = TRUE)
add_med_gifts2016 &lt;- median(donations2016$`Additional Gift Amount($)`, na.rm = TRUE)
add_med_gifts2017 &lt;- median(donations2017$`Additional Gift Amount($)`, na.rm = TRUE)

add_donations &lt;- tibble(2013:2017,
  c(add_tot_gifts2013, add_tot_gifts2014, add_tot_gifts2015, add_tot_gifts2016, add_tot_gifts2017), 
  c(add_med_gifts2013, add_med_gifts2014, add_med_gifts2015, add_med_gifts2016, add_med_gifts2017))

colnames(add_donations) &lt;- c(&quot;Year&quot;, &quot;Additional Donations&quot;, &quot;Median&quot;)</code></pre>
</div>
<div id="plotting-donations-data" class="section level2">
<h2>Plotting donations data</h2>
<pre><code>ggplot(data = subset(donations2013, !is.na(`Donor Gender`))) + 
  geom_bar(aes(`Donor Gender`, fill = `Donor Gender`), na.rm = TRUE) + 
  xlab(&quot;Donor Gender&quot;) + 
  ylab(&quot;Count&quot;) + 
  ggtitle(&quot;2013 NMS Participants by gender&quot;)

ggplot(data = subset(donations2013, !is.na(`Gift Payment Method`))) + 
  geom_bar(aes(`Gift Payment Method`, fill = `Donor Gender`)) + 
  xlab(&quot;Gift Payment Method&quot;) + 
  ylab(&quot;Dollars&quot;) + 
  ggtitle(&quot;2013 NMS Gift Payment Method Types by Gender&quot;)

library(scales)
ggplot(tot_donations, aes(Year, `Total Donations`/1000000)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;)) + 
  ylab(&quot;Gift Amount ($M)&quot;) + 
  ggtitle(&quot;Gift amounts have fallen every year since 2014&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Gift amounts have fallen.png&quot;)


ggplot(add_donations, aes(Year, `Additional Donations`/1000000)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;)) + 
  ylab(&quot;Additional gift Amount ($M)&quot;) + 
  ggtitle(&quot;Additional gift amounts were increasing but fell in 2017&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Additional gift amounts were increasing.png&quot;)




colnames(add_donations)


ggplot() + 
  geom_bar(data = tot_donations, aes(Year, `Total Donations` / 1000000), stat = &quot;identity&quot;) +
  geom_bar(data = add_donations, aes(Year, `Additional Donations` /1000000), stat = &quot;identity&quot;, fill = &quot;red&quot;, alpha = 0.6)  
  

participants &lt;- tibble(2013:2017, c(nrow(donations2013), nrow(donations2014), nrow(donations2015), nrow(donations2016), nrow(donations2017)))

colnames(participants) &lt;- c(&quot;Year&quot;, &quot;Participants&quot;)

ggplot(participants) + 
  geom_bar(aes(x = Year, y = Participants), stat = &quot;identity&quot;) + 
  ylim(0, 1000000) + 
  scale_y_continuous(labels= comma) +
  ggtitle(&quot;Number of participants has fallen every year since 2013&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Number of participants has fallen.png&quot;)

  
don_per_part = tibble(2013:2017, tot_donations$`Total Donations` / participants$Participants)
colnames(don_per_part) &lt;- c(&quot;Year&quot;, &quot;Average Donation&quot;)

ggplot(don_per_part, aes(Year, `Average Donation`)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  ylab(&quot;Averate Gift Amount&quot;) + 
  ggtitle(&quot;Average gift per participant has increased every year since 2013&quot;) + 
    theme(plot.title = element_text(hjust = 0.5)) + 
  ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Average gift per participant has increased.png&quot;)


</code></pre>
</div>
<div id="ramyas-bike-events-data-aggregation" class="section level2">
<h2>Ramya’s Bike Events Data Aggregation</h2>
<pre><code>#Average amount by total participants in all the states
Amount_by_States&lt;-aggregate(BikeEvents$Total.From.Participant..., by=list(State = BikeEvents$State), FUN = mean)
head(Amount_by_States)
</code></pre>
<pre><code>#Amount raised by participants from 2013-2017
Amount_by_year &lt;-aggregate(BikeEvents$Total.From.Participant..., by = list(year = BikeEvents$Fiscal.Year), sum)
Amount_by_year</code></pre>
<pre><code>#selft donars over
Donors_by_year &lt;-aggregate(BikeEvents$Total.From.Participant..., by = list(year = BikeEvents$Fiscal.Year), sum)
Donors_by_year
</code></pre>
<pre><code>#Active registrations overs the years
Active_registrations &lt;-aggregate(BikeEvents$Active.Registrations, by = list(year = BikeEvents$Fiscal.Year), sum)
Active_registrations
</code></pre>
</div>
<div id="ramyas-plots" class="section level2">
<h2>Ramya’s Plots</h2>
<pre><code>library(&#39;ggplot2&#39;)
Amounts_ggplot&lt;-ggplot(Amount_by_States, aes(x=Amount_by_States$State,y=Amount_by_States$x))+ 
  theme(axis.text.x = element_text(face = &quot;bold&quot;, size = 8, angle = 90))+
  geom_bar(stat = &#39;identity&#39;, fill = &quot;blue&quot;)+
  ggtitle(&quot;Average amount raised by Bike Events participants across all the states&quot;) + 
  labs(x =&#39;States&#39;, y = &#39;Average amount&#39;)</code></pre>
<pre><code>Amounts_ggplot
ggsave(filename=&quot;D:/527- Data Mining/TUN Data Challenge/Data Visualizations/Amounts_ggplot.pdf&quot;, plot=Amounts_ggplot)
</code></pre>
<pre><code>ggplot(Amount_by_year, aes(x = Amount_by_year$year, y = Amount_by_year$x)) +
  geom_bar(stat = &#39;identity&#39;, fill = &quot;blue&quot;)+ggtitle(&quot;Participants amount to Bike events slightly decreasing since 2014&quot;) + 
  labs(x =&#39;Year&#39;, y = &#39;Total amount&#39;)
</code></pre>
<pre><code>#Donars by year
ggplot(Donors_by_year, aes(x = Donors_by_year$year, y = Donors_by_year$x))+
  geom_bar(stat = &#39;identity&#39;, fill = &quot;blue&quot;)+ggtitle(&quot;Self donors gradually decreasing since 2014 &quot;) + 
  labs(x =&#39;Year&#39;, y = &#39;Total amount&#39;)

</code></pre>
<pre><code>#Donars by year
ggplot(Active_registrations, aes(x = Active_registrations$year, y = Active_registrations$x)) +
  geom_bar(stat = &#39;identity&#39;, fill = &quot;blue&quot;)+ggtitle(&quot;Active registrations have fallen since 2013 &quot;) + 
  labs(x =&#39;Year&#39;, y = &#39;No of registrations&#39;)
</code></pre>
</div>
<div id="participants-eda" class="section level2">
<h2>Participants EDA</h2>
<pre><code># some basic data viz
barplot(table(participants$`Participant Occupation`), ylab = &quot;Count&quot;, main = &quot;Occupations of our Participants&quot;,
        ylim = c(0,2500), las = 2, col=rgb(0.2,0.4,0.6,0.6))

occ.count &lt;- table(participants$`Participant Occupation`)
occ.count
occupation.viz &lt;- ggplot(data = participants, aes(x = participants$`Participant Occupation`)) + 
  geom_bar(aes(y = (..count..), fill = `Participant Gender`)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

occupation.viz + labs(x = &quot;Occupations&quot;) + 
  labs(title = &quot;Frequency of Participant Occupation&quot;) + 
  labs(y = &quot;Count&quot;)</code></pre>
<pre><code>library(readr)
library(dplyr)
library(ggplot2)
library(scales)

donations2013 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2013.rds&quot;)
donations2014 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2014.rds&quot;)
donations2015 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2015.rds&quot;)
donations2016 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2016.rds&quot;)
donations2017 &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Donations/Donations2017.rds&quot;)

participants &lt;- readRDS(&quot;C:/Users/Konrad/Desktop/ETM 527/RDS Data/Participants/Participants.rds&quot;)

#summary(donations2017$`Donor Gender`)
#levels(donations2017$`Donor Gender`) &lt;- list(Male = &quot;Male&quot;, Female = &quot;Female&quot;, None = &quot;&quot;)</code></pre>
</div>
</div>
<div id="creating-data-aggregations-1" class="section level1">
<h1>Creating Data Aggregations</h1>
<div id="from-donations-data-1" class="section level2">
<h2>From donations data</h2>
<pre><code># gen_2013 &lt;- summary(donations2013$`Donor Gender`)
# gen_2014 &lt;- summary(donations2014$`Donor Gender`)
# gen_2015 &lt;- summary(donations2015$`Donor Gender`)
# gen_2016 &lt;- summary(donations2016$`Donor Gender`)
# gen_2017 &lt;- summary(donations2017$`Donor Gender`)
# 
# 
# gender_year &lt;- tibble(c(2013, 2014, 2015, 2016, 2017), 
#                           c(gen_2013[1], gen_2014[1], gen_2015[1], gen_2016[1], gen_2017[1]), 
#                           c(gen_2013[2], gen_2014[2], gen_2015[2], gen_2016[2], gen_2017[2]), 
#                           c(gen_2013[3], gen_2014[3], gen_2015[3], gen_2016[3], gen_2017[3]),
#                           c(gen_2013[4], gen_2014[4], gen_2015[4], gen_2016[4], gen_2017[4]))
#                           
# colnames(gender_year) &lt;- c(&quot;Year&quot;, &quot;Female&quot;, &quot;Male&quot;, &quot;None&quot;, &quot;NA&quot;)
# 
# 
# year_num &lt;- tibble(2013:2017, c(nrow(donations2013), nrow(donations2014), nrow(donations2015), nrow(donations2016), nrow(donations2017)))
# colnames(year_num) &lt;- c(&quot;Year&quot;, &quot;Number of Participants&quot;)
# 
# 
# tot_gifts2013 &lt;- sum(donations2013$`Gift Amount($)`, na.rm = TRUE)
# tot_gifts2014 &lt;- sum(donations2014$`Gift Amount($)`, na.rm = TRUE)
# tot_gifts2015 &lt;- sum(donations2015$`Gift Amount($)`, na.rm = TRUE)
# tot_gifts2016 &lt;- sum(donations2016$`Gift Amount($)`, na.rm = TRUE)
# tot_gifts2017 &lt;- sum(donations2017$`Gift Amount($)`, na.rm = TRUE)
# 
# med_gifts2013 &lt;- median(donations2013$`Gift Amount($)`, na.rm = TRUE)
# med_gifts2014 &lt;- median(donations2014$`Gift Amount($)`, na.rm = TRUE)
# med_gifts2015 &lt;- median(donations2015$`Gift Amount($)`, na.rm = TRUE)
# med_gifts2016 &lt;- median(donations2016$`Gift Amount($)`, na.rm = TRUE)
# med_gifts2017 &lt;- median(donations2017$`Gift Amount($)`, na.rm = TRUE)
# 
# mean_gifts2013 &lt;- mean(donations2013$`Gift Amount($)`, na.rm = TRUE)
# mean_gifts2014 &lt;- mean(donations2014$`Gift Amount($)`, na.rm = TRUE)
# mean_gifts2015 &lt;- mean(donations2015$`Gift Amount($)`, na.rm = TRUE)
# mean_gifts2016 &lt;- mean(donations2016$`Gift Amount($)`, na.rm = TRUE)
# mean_gifts2017 &lt;- mean(donations2017$`Gift Amount($)`, na.rm = TRUE)
# 
# 
# tot_donations &lt;- tibble(2013:2017,
#                             c(tot_gifts2013, tot_gifts2014, tot_gifts2015, tot_gifts2016, tot_gifts2017),
#                             c(med_gifts2013, med_gifts2014, med_gifts2015, med_gifts2016, med_gifts2017), 
#                             c(mean_gifts2013, mean_gifts2014, mean_gifts2015, mean_gifts2016, mean_gifts2017))
# 
# colnames(tot_donations) &lt;- c(&quot;Year&quot;, &quot;Total Donations&quot;, &quot;Median&quot;, &quot;Mean&quot;)
# 
# add_tot_gifts2013 &lt;- sum(donations2013$`Additional Gift Amount($)`, na.rm = TRUE)
# add_tot_gifts2014 &lt;- sum(donations2014$`Additional Gift Amount($)`, na.rm = TRUE)
# add_tot_gifts2015 &lt;- sum(donations2015$`Additional Gift Amount($)`, na.rm = TRUE)
# add_tot_gifts2016 &lt;- sum(donations2016$`Additional Gift Amount($)`, na.rm = TRUE)
# add_tot_gifts2017 &lt;- sum(donations2017$`Additional Gift Amount($)`, na.rm = TRUE)
# 
# add_med_gifts2013 &lt;- median(donations2013$`Additional Gift Amount($)`, na.rm = TRUE)
# add_med_gifts2014 &lt;- median(donations2014$`Additional Gift Amount($)`, na.rm = TRUE)
# add_med_gifts2015 &lt;- median(donations2015$`Additional Gift Amount($)`, na.rm = TRUE)
# add_med_gifts2016 &lt;- median(donations2016$`Additional Gift Amount($)`, na.rm = TRUE)
# add_med_gifts2017 &lt;- median(donations2017$`Additional Gift Amount($)`, na.rm = TRUE)
# 
# add_mean_gifts2013 &lt;- mean(donations2013$`Additional Gift Amount($)`, na.rm = TRUE)
# add_mean_gifts2014 &lt;- mean(donations2014$`Additional Gift Amount($)`, na.rm = TRUE)
# add_mean_gifts2015 &lt;- mean(donations2015$`Additional Gift Amount($)`, na.rm = TRUE)
# add_mean_gifts2016 &lt;- mean(donations2016$`Additional Gift Amount($)`, na.rm = TRUE)
# add_mean_gifts2017 &lt;- mean(donations2017$`Additional Gift Amount($)`, na.rm = TRUE)
# 
# 
# add_donations &lt;- tibble(2013:2017,
#   c(add_tot_gifts2013, add_tot_gifts2014, add_tot_gifts2015, add_tot_gifts2016, add_tot_gifts2017), 
#   c(add_med_gifts2013, add_med_gifts2014, add_med_gifts2015, add_med_gifts2016, add_med_gifts2017), 
#   c(add_mean_gifts2013, add_mean_gifts2014, add_mean_gifts2015, add_mean_gifts2016, add_mean_gifts2017))
# 
# colnames(add_donations) &lt;- c(&quot;Year&quot;, &quot;Additional Donations&quot;, &quot;Median&quot;, &quot;Mean&quot;)
# 
# 
# write_rds(tot_donations, &quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Gift Amounts.rds&quot;)
# write_rds(add_donations, &quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Additional Amounts.rds&quot;)
# write_rds(gender_year, &quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Yearly Gender Breakdown.rds&quot;)
# 
# gen_tot_2013_gifts &lt;- aggregate(donations2013$`Gift Amount($)`, by = list(donations2013$`Donor Gender`), FUN = sum)
# gen_med_2013_gifts &lt;- aggregate(donations2013$`Gift Amount($)`, by = list(donations2013$`Donor Gender`), FUN = median)  
# gen_mean_2013_gifts &lt;- aggregate(donations2013$`Gift Amount($)`, by = list(donations2013$`Donor Gender`), FUN = mean)
# 
# gen_tot_2014_gifts &lt;- aggregate(donations2014$`Gift Amount($)`, by = list(donations2014$`Donor Gender`), FUN = sum)
# gen_med_2014_gifts &lt;- aggregate(donations2014$`Gift Amount($)`, by = list(donations2014$`Donor Gender`), FUN = median)  
# gen_mean_2014_gifts &lt;- aggregate(donations2014$`Gift Amount($)`, by = list(donations2014$`Donor Gender`), FUN = mean)
# 
# gen_tot_2015_gifts &lt;- aggregate(donations2015$`Gift Amount($)`, by = list(donations2015$`Donor Gender`), FUN = sum)
# gen_med_2015_gifts &lt;- aggregate(donations2015$`Gift Amount($)`, by = list(donations2015$`Donor Gender`), FUN = median)  
# gen_mean_2015_gifts &lt;- aggregate(donations2015$`Gift Amount($)`, by = list(donations2015$`Donor Gender`), FUN = mean)
# 
# gen_tot_2016_gifts &lt;- aggregate(donations2016$`Gift Amount($)`, by = list(donations2016$`Donor Gender`), FUN = sum)
# gen_med_2016_gifts &lt;- aggregate(donations2016$`Gift Amount($)`, by = list(donations2016$`Donor Gender`), FUN = median)  
# gen_mean_2016_gifts &lt;- aggregate(donations2016$`Gift Amount($)`, by = list(donations2016$`Donor Gender`), FUN = mean)
# 
# gen_tot_2017_gifts &lt;- aggregate(donations2017$`Gift Amount($)`, by = list(donations2017$`Donor Gender`), FUN = sum)
# gen_med_2017_gifts &lt;- aggregate(donations2017$`Gift Amount($)`, by = list(donations2017$`Donor Gender`), FUN = median)  
# gen_mean_2017_gifts &lt;- aggregate(donations2017$`Gift Amount($)`, by = list(donations2017$`Donor Gender`), FUN = mean)
# 
# gender_year_totals &lt;- rbind(gen_tot_2013_gifts, gen_tot_2014_gifts, gen_tot_2015_gifts, gen_tot_2016_gifts, gen_tot_2017_gifts)
# 
# gender_year_med &lt;- rbind(gen_med_2013_gifts, gen_med_2014_gifts, gen_med_2015_gifts, gen_med_2016_gifts, gen_med_2017_gifts)
# 
# gender_year_mean &lt;- rbind(gen_mean_2013_gifts, gen_mean_2014_gifts, gen_mean_2015_gifts, gen_mean_2016_gifts, gen_mean_2017_gifts)
# 
# gender_totals &lt;- tibble(rep(2013:2017, each = 3), 
#                         rep(c(&quot;Female&quot;, &quot;Male&quot;, &quot;None&quot;), times = 5), 
#                         gender_year_totals$x, 
#                         gender_year_med$x, 
#                         gender_year_mean$x)
# 
# colnames(gender_totals) &lt;- c(&quot;Year&quot;, &quot;Gender&quot;, &quot;Total Gifts&quot;, &quot;Median&quot;, &quot;Mean&quot;)
# 
# write_rds(gender_totals, &quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Gender Year Totals Breakdown.rds&quot;)
</code></pre>
<pre><code>tot_donations &lt;- read_rds(&quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Gift Amounts.rds&quot;)
add_donations &lt;- read_rds(&quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Additional Amounts.rds&quot;)
gender_year &lt;- read_rds(&quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Yearly Gender Breakdown.rds&quot;)
gender_totals &lt;- read_rds(&quot;C:/Users/Konrad/Desktop/ETM 527/Calculated/Gender Year Totals Breakdown.rds&quot;)
</code></pre>
<div id="total-donations" class="section level5">
<h5>Total Donations</h5>
<pre><code>ggplot(tot_donations, aes(Year, `Total Donations`)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  scale_y_continuous(labels = comma) + 
  ylab(&quot;Participants&quot;) + 
  ggtitle(&quot;The number of participants has fallen every year since 2014&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(plot.title = element_text(size = 18, face = &quot;bold&quot;)) #+
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Participant numbers fallen.png&quot;)

ggplot(participants, aes(`Fiscal Year`)) + 
  geom_bar() + 
  scale_y_continuous(labels = comma) + 
  ylab(&quot;Participants&quot;) + 
  xlab(&quot;Fiscal Year&quot;) + 
  ggtitle(&quot;Number of participants has decreased every year&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme(plot.title = element_text(size =18, face = &quot;bold&quot;)) #+
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Number of participants decreased every year.png&quot;, width = 10)</code></pre>
</div>
</div>
<div id="sum-of-donations" class="section level2">
<h2>Sum of Donations</h2>
<pre><code>ggplot(tot_donations, aes(Year, `Total Donations`/1000000)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;)) + 
  ylab(&quot;Gift Amount ($M)&quot;) + 
  ggtitle(&quot;Total gift amounts have fallen every year since 2014&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) #+ 
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Gift amounts have fallen.png&quot;)</code></pre>
<div id="mean-donations" class="section level3">
<h3>Mean Donations</h3>
<pre><code>ggplot(tot_donations, aes(Year, Mean)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;)) + 
  ylab(&quot;Gift Amount&quot;) + 
  ggtitle(&quot;Mean gift amount continues to rise&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) #+ 
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Gift amounts have fallen.png&quot;)</code></pre>
</div>
<div id="median-donations" class="section level3">
<h3>Median Donations</h3>
<pre><code>ggplot(tot_donations, aes(Year, Median)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;)) + 
  ylab(&quot;Gift Amount&quot;) + 
  ggtitle(&quot;Median gift amount remains unchanged&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) #+ 
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Gift amounts have fallen.png&quot;)</code></pre>
<div id="gender-totals" class="section level5">
<h5>Gender Totals</h5>
<pre><code>ggplot(gender_totals[order(gender_totals$Gender),], aes(Year, `Total Gifts`/1000000, fill = Gender)) + 
  geom_bar(stat = &quot;identity&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;, suffix = &quot;M&quot;)) + 
  scale_fill_manual(values=c(&quot;#A92A2A&quot;, &quot;#205A8F&quot;, &quot;#B4BFC3&quot;)) +
  ylab(&quot;Gift Amount (M)&quot;) + 
  ggtitle(&quot;Total gift amount has decreased&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(plot.title = element_text(size =18, face = &quot;bold&quot;)) #+
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Total gift amounts by gender.png&quot;, width = 12)

ggplot(gender_totals, aes(Year, Median, fill = Gender)) + 
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;)) + 
  scale_fill_manual(values=c(&quot;#A92A2A&quot;, &quot;#205A8F&quot;, &quot;#B4BFC3&quot;)) +
  ylab(&quot;Gift Amount ($)&quot;) + 
  ggtitle(&quot;Median gift amount remains unchanged&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme(plot.title = element_text(size =18, face = &quot;bold&quot;)) #+
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Median gift amounts by gender.png&quot;, width = 12)


ggplot(gender_totals, aes(Year, Mean, fill = Gender)) + 
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) + 
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;)) +  
  scale_fill_manual(values = c(&quot;#A92A2A&quot;, &quot;#205A8F&quot;, &quot;#B4BFC3&quot;)) +
  ylab(&quot;Gift Amount ($)&quot;) + 
  ggtitle(&quot;Mean gift amount has fluctuated&quot;) + 
  theme(plot.title = element_text(hjust = 0.5)) + 
  theme(plot.title = element_text(size =18, face = &quot;bold&quot;)) #+
  #ggsave(&quot;C:\\Users\\Konrad\\Desktop\\ETM 527\\Mean gift amounts by gender.png&quot;, width = 12)

</code></pre>
<pre><code>library(dplyr)
library(magrittr)
library(tidyr)
library(knitr)
library(tibble)
library(readxl)
library(graphics)
library(ggplot2)
library(scales)
library(RColorBrewer)</code></pre>
<pre><code>nt &lt;-
read_excel(&quot;C:/Users/eva/Documents/ETM 527/Data Challenge 2018/National Teams/2013-2017 National Team Activity.xlsx&quot;, skip = 1, na = c(&quot;NA&quot;, &quot; &quot;, &quot;-999&quot;),
           col_types = c(&quot;text&quot;, &quot;text&quot;, &quot;text&quot;, 
                         &quot;text&quot;, &quot;text&quot;, &quot;text&quot;, &quot;date&quot;, &quot;text&quot;, 
                         &quot;numeric&quot;, &quot;numeric&quot;, &quot;numeric&quot;, 
                         &quot;numeric&quot;, &quot;numeric&quot;, &quot;text&quot;, &quot;text&quot;, 
                         &quot;text&quot;, &quot;text&quot;, &quot;text&quot;, &quot;text&quot;, &quot;text&quot;, 
                         &quot;text&quot;, &quot;numeric&quot;, &quot;text&quot;, &quot;text&quot;, 
                         &quot;text&quot;, &quot;text&quot;, &quot;text&quot;))

dim(nt)</code></pre>
<pre><code>#Removing the &quot;Corporate Name&quot; field as it was blank for all recornt
nt$&#39;Corporate Name&#39; &lt;- NULL
str(nt)</code></pre>
<pre><code>nt$`Event Chapter` &lt;- as.factor(nt$`Event Chapter`)
nt$`Event Category` &lt;- as.factor(nt$`Event Category`)
nt$`Event Type` &lt;- as.factor(nt$`Event Type`)
nt$`Local Team Name` &lt;- as.factor(nt$`Local Team Name`)
nt$`Event Name` &lt;- as.factor(nt$`Event Name`)
nt$Location &lt;- as.factor(nt$Location)

cols_to_factor &lt;- 12:ncol(nt)

nt[, cols_to_factor] &lt;- lapply(nt[, cols_to_factor], as.factor) 
</code></pre>
<pre><code># Fill down team names
for (i in 2:nrow(nt))
{
  if (is.na(nt$`National Team Name`[i]) &amp; !is.na(nt$`National Team Name`[i-1]))
  {
    nt$`National Team Name`[i] &lt;- nt$`National Team Name`[i-1]
  }
}
View(nt)
</code></pre>
<pre><code># add NA in the Team Name where applicable
nt$`National Team Name` &lt;- as.factor(nt$`National Team Name`)
summary(nt$`National Team Name`)

nt$`National Team Name`[nt$`National Team Name` == &quot;N/A&quot;] &lt;- NA  #selects all matching rows and changes to NA
summary(nt$`National Team Name`)

</code></pre>
<pre><code>

Not.National.Team = subset(nt, is.na(nt$`National Team Name`), select =`National Team Name`:`Primary Connection To MS`)
Not.National.Team = Not.National.Team[,c(5,6,2,3,4,7:26)]

nt &lt;- nt[which(!is.na(nt$`National Team Name`)),]
nt &lt;- nt[which(!is.na(nt$`Local Team Name`)),]</code></pre>
<pre><code>NameLocation &lt;- nt$Location
summary(NameLocation)
BlankLocation &lt;- nt[which(is.na(nt$Location)), ]
View(BlankLocation)
</code></pre>
<pre><code>

</code></pre>
<pre><code>
View(nt)

sink(&quot;C:/Users/eva/Documents/ETM 527/Data Challenge 2018/National Teams/National Teams Basic Exploration.txt&quot;)
class(nt)
dim(nt)
glimpse(nt)
head(nt)
tail(nt)
summary(nt)
str(nt)
sink()</code></pre>
<pre><code>library(dplyr)
teams.count = count(nt,team =nt$`National Team Name`)
teams.count$team = factor(teams.count$team, levels = teams.count$team[order(teams.count$n)])
filter.top.count = filter(teams.count,n&gt;15)
</code></pre>
<pre><code>ggplot(filter.top.count, aes(team,n)) + 
  geom_bar(stat = &quot;identity&quot;, aes(`team`, fill = `team`)) + coord_flip()+theme(axis.text=element_text(size=7),
        axis.title=element_text(size=14,face=&quot;bold&quot;))+
  ylab(&quot;Count&quot;) + 
  xlab(&quot;National Team&quot;) + 
  ggtitle(&quot;2013 NMSS National Team Participation&quot;)+
  scale_size_continuous()
ggsave(&quot;C:/Users/eva/Documents/ETM 527/Data Challenge 2018/National Teams/National Team Participation.png&quot;)</code></pre>
<pre><code>Teams.Revenue = nt[c(1, 9)]
Teams.Revenue = aggregate(Teams.Revenue$`Revenue Raised`, by=list(`National Team Name`=Teams.Revenue$`National Team Name`), FUN=sum)
names(Teams.Revenue) = c(&quot;National Team Name&quot;, &quot;Total Revenue Raised&quot;)
Teams.Revenue$`National Team Name` = factor(Teams.Revenue$`National Team Name`, levels = Teams.Revenue$`National Team Name`[order(Teams.Revenue$`Total Revenue Raised`)])
filter.top.revenue = filter(Teams.Revenue,`Total Revenue Raised`&gt;100000)
</code></pre>
<pre><code>ggplot(filter.top.revenue, aes(`National Team Name`, `Total Revenue Raised`/10000))+ 
  geom_bar(stat = &quot;identity&quot;, aes(`National Team Name`, fill = `National Team Name`)) +
  scale_y_continuous(labels=dollar_format(prefix=&quot;$&quot;))+
  ylab(&quot;Total Revenue Raised (in 10 thousands)&quot;) + 
  xlab(&quot;National Team Name&quot;) +   coord_flip()+ 
  ggtitle(&quot;2013 NMSS Top Fundraising National Teams&quot;)+ scale_fill_discrete(breaks = rev(levels(filter.top.revenue$`National Team Name`)))
scale_size_continuous()
ggsave(&quot;C:/Users/eva/Documents/ETM 527/Data Challenge 2018/National Teams/Visuals/Top Funraising National Team.png&quot;)
</code></pre>
<pre><code>Connection = count(Not.National.Team, pcms=Not.National.Team$`Primary Connection To MS`)
Connection2 = count(nt, pcms=nt$`Primary Connection To MS`)

Connection$pcms = factor(Connection$pcms, levels = Connection$pcms[order(Connection$n)])
Connection2$pcms = factor(Connection2$pcms, levels = Connection2$pcms[order(Connection2$n)])

connect &lt;- cbind(Connection,Connection2)
connect &lt;- cbind(Connection, Connection2[,2])

Connect &lt;- rowSums(connect[2:3]) 
connect &lt;- cbind(connect,Connect)

connect &lt;- connect[,c(1,4)]
connect$Connect &lt;- as.integer(connect$Connect)
connect$pcms = factor(connect$pcms, levels = connect$pcms[order(connect$Connect)])
connect &lt;- arrange(connect, desc(Connect))

names(connect) = c(&quot;Primary Connection to MS&quot;, &quot;Number of Participants&quot;)
</code></pre>
<pre><code>ggplot(connect, aes(`Primary Connection to MS`, `Number of Participants`))+
   geom_bar(stat =  &quot;identity&quot;, aes(`Primary Connection to MS`, fill = `Primary Connection to MS`))+
   xlab(&quot;Primary Connection To MS&quot;) +
   ylab(&quot;Number of Team Members&quot;) + coord_flip() + theme(axis.text=element_text(size=7),
        axis.title=element_text(size=14,face=&quot;bold&quot;))+
   ggtitle(&quot;2013 NMSS Primary Connection to MS National &amp; Not National Teams&quot;)+
   scale_size_continuous()+ scale_y_continuous()
ggsave(&quot;C:/Users/eva/Documents/ETM 527/Data Challenge 2018/National Teams/Visuals/Primary Connection to MS.png&quot;)

</code></pre>
<pre><code># SaveRDS
saveRDS(nt,&quot;National_Teams_cleaned&quot;)
saveRDS(Not.National.Team,&quot;Not_Nationa_Team_from_NT&quot;)
</code></pre>
</div>
</div>
</div>
</div>
<div id="business-question-what-is-the-common-denominator-for-our-top-performing-corporate-teams" class="section level1">
<h1>Business question : What is the common denominator for our top performing corporate teams?</h1>
<p>#(Is it industry, culture, executive involvement, connection to MS, other?)</p>
<pre><code>library(tidyverse)
library(ggpubr)
library(ggplot2)
library(magrittr)</code></pre>
</div>
<div id="just-want-corporate-teams" class="section level1">
<h1>just want corporate teams</h1>
<pre><code>corp &lt;- teams %&gt;%
  select(everything()) %&gt;%
  filter(`Team Division` == &quot;Corporate&quot;)</code></pre>
</div>
<div id="clean-up" class="section level1">
<h1>clean up</h1>
<pre><code>corp$`Fiscal Year` &lt;- as.factor(corp$`Fiscal Year`)
corp$`Team Goal($)` &lt;- as.numeric(corp$`Team Goal($)`)
corp$`Number of Participants` &lt;- as.numeric(corp$`Number of Participants`)
corp$Company[corp$Company == &quot;Team BP&quot;] &lt;- &quot;BP&quot;</code></pre>
</div>
<div id="try-some-correlations" class="section level1">
<h1>try some correlations</h1>
<pre><code>corp.goal.part &lt;- cor(corp$`Team Goal($)`, corp$`Number of Participants`, method = &quot;pearson&quot;, use = &quot;complete.obs&quot;)
summary(corp.goal.part)

plot(x, y, main = &quot;Correlation : Team Goal Increase with More Team Members&quot;,
     xlab = &quot;Number of Participants&quot;, ylab = &quot;Total Team Gift&quot;,
     pch = 19, frame = FALSE)
abline(lm(y ~ x, data = corp), col = &quot;blue&quot;)</code></pre>
</div>
<div id="number-of-participats" class="section level1">
<h1>number of participats</h1>
<pre><code>corp.event &lt;- corp %&gt;%
  select(`Internal Event Name`, `Fiscal Year`, `Number of Participants`, Company) %&gt;%
  group_by(`Fiscal Year`, Company) %&gt;%
  filter(!is.na(Company))

corp.event.participants &lt;- corp.event %&gt;%
  select(`Fiscal Year`, `Number of Participants`, Company) %&gt;%
  group_by(`Fiscal Year`, Company) %&gt;%
  summarise(sum(`Number of Participants`))

colnames(corp.event.participants)[3] &lt;- &quot;N&quot;

year.participants &lt;- corp.event.participants %&gt;%
  select(`Fiscal Year`, `N`) %&gt;%
  group_by(`Fiscal Year`) %&gt;%
  summarise(sum(N))</code></pre>
</div>
<div id="top-10-corps" class="section level1">
<h1>top 10 corps</h1>
<pre><code>top.10.corp &lt;- corp %&gt;%
  select(everything()) %&gt;%
  group_by(Company) %&gt;%
  filter(!is.na(Company)) %&gt;%
  summarise(sum(`Total Confirmed Gifts in Team History($)`)) %&gt;%
  top_n(10)</code></pre>
</div>
<div id="dataframe-of-vars-for-top-corps" class="section level1">
<h1>dataframe of vars for top corps</h1>
<pre><code>top.corps &lt;- top.10.corp$Company

top.corps.common &lt;- corp %&gt;%
  select(everything()) %&gt;%
  filter(Company %in% top.corps)</code></pre>
</div>
<div id="trying-to-time-series" class="section level1">
<h1>trying to time series</h1>
<pre><code>corp$`Event Date` &lt;- as.Date(corp$`Event Date`, &quot;%m/%d/%Y&quot;)
top.corps.common$`Date` &lt;- as.Date(top.corps.common$`Event Date`, &quot;%m/%d/%Y&quot;)
top.corps.common$DateYear &lt;- lubridate::year(top.corps.common$Date)

corp.gift.ts &lt;- ts(corp$`Team Total Confirmed ($)`, frequency = , start = 2013)

tsData &lt;- top.corps.common[,28]
decomposeRes &lt;- decompose(tsData, type = &quot;additive&quot;)</code></pre>
</div>
<div id="ggplot-number-of-participants-for-top-corp-teams" class="section level1">
<h1>ggplot number of participants for top corp teams</h1>
<pre><code>corp.event.viz &lt;- ggplot(top.corps.common, aes(x = `Date`, y = `Number of Participants`, fill = Company)) +
  geom_area()
corp.event.viz</code></pre>
</div>
<div id="plotly-avg-number-of-participants-for-top-corporate-teams" class="section level1">
<h1>plotly avg number of participants for top corporate teams</h1>
<pre><code>avg.participants.top.corps &lt;- top.corps.common %&gt;%
  select(Company, `Number of Participants`) %&gt;%
  group_by(Company) %&gt;%
  summarise(avg = mean(`Number of Participants`))

density &lt;- density(avg.participants.top.corps$`avg`)

overall.avg.number.participants &lt;- plotly::plot_ly(x = ~density$x, y = ~density$y, type = &#39;scatter&#39;, mode = &#39;lines&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  layout(xaxis = list(title = &#39;Number of Participants&#39;),
         yaxis = list(title = &#39;Density&#39;))
overall.avg.number.participants</code></pre>
</div>
<div id="area-for-each-company" class="section level1">
<h1>area for each company</h1>
<pre><code>top.corps.participants &lt;- top.corps.common %&gt;%
  select(Company, `Event ID`, `Number of Participants`) %&gt;%
  filter(Company %in% top.corps) %&gt;%
  group_by(Company,`Event ID`) %&gt;%
  summarise(sum = sum(`Number of Participants`))

Company %in% top.corps

team1 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;BP&quot;),]
density1 &lt;- density(team1$`Number of Participants`)

team2 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;Calpine Corporation&quot;),]
density2 &lt;- density(team2$`Number of Participants`)

team3 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;CGG&quot;),]
density3 &lt;- density(team3$`Number of Participants`)

team4 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;ConocoPhillips&quot;),]
density4 &lt;- density(team4$`Number of Participants`)

team5 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;ExxonMobil Cycling Team&quot;),]
density5 &lt;- density(team5$`Number of Participants`)

team6 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;Noble Drilling Services Inc.&quot;),]
density6 &lt;- density(team6$`Number of Participants`)

team7 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;Saint Arnold Brewing Company&quot;),]
density7 &lt;- density(team7$`Number of Participants`)

team8 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;Salesforce Bike MS&quot;),]
density8 &lt;- density(team8$`Number of Participants`)

team9 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;Team Shell&quot;),]
density9 &lt;- density(team9$`Number of Participants`)

team10 &lt;- top.corps.common[which(top.corps.participants$Company == &quot;The Houstonian Club, Hotel and Spa&quot;),]
density10 &lt;- density(team10$`Number of Participants`)

top.corps.participants.viz &lt;- plot_ly(x = ~density1$x, y = ~density1$y, type = &#39;scatter&#39;, mode = &#39;lines&#39;, name = &#39;BP&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density2$x, y = ~density2$y, name = &#39;Calpine Corporation&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density3$x, y = ~density3$y, name = &#39;CGG&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density4$x, y = ~density4$y, name = &#39;ConocoPhillips&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density5$x, y = ~density5$y, name = &#39;ExxonMobil Cycling Team&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density6$x, y = ~density6$y, name = &#39;Noble Drilling Services Inc.&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density7$x, y = ~density7$y, name = &#39;Saint Arnold Brewing Company&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density8$x, y = ~density8$y, name = &#39;Salesforce Bike MS&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density9$x, y = ~density9$y, name = &#39;Team Shell&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  add_trace(x = ~density10$x, y = ~density10$y, name = &#39;The Houstonian Club, Hotel and Spa&#39;, fill = &#39;tozeroy&#39;) %&gt;%
  layout(xaxis = list(title = &#39;Number of Participants per Event&#39;),
         yaxis = list(title = &#39;Density&#39;),
         main)
top.corps.participants.viz</code></pre>
</div>
<div id="stream-plots" class="section level1">
<h1>stream plots</h1>
<pre><code>corp.density.link = api_create(top.corps.participants.viz, filename=&quot;Participant Density for Top Corporate Teams&quot;)
corp.density.link</code></pre>
<pre><code>east.health.viz &lt;- ggplot(east.health, aes(x = reorder(`Participant State`, -Count), 
                                           y = `Count`,
                                           fill = `Participant State`)) + 
  geom_bar(stat = &quot;identity&quot;)
east.health.viz +
  labs(x = &quot;Number of Participants&quot;,
       y = &quot;State&quot;,
       title = &quot;Number of Cyclists Working in Healthcare Within the Target Region&quot;)</code></pre>
</div>
<div id="mean-donation-for-each-event" class="section level1">
<h1>mean donation for each event</h1>
<pre><code>gender.gifts &lt;- gender.vip %&gt;%
  select(`Participant Gender`, `Event Date`, `Total From Participant($)`) %&gt;%
  group_by(`Participant Gender`, `Event Date`)
gender.gifts$`Event Date` &lt;- as.Date(gender.gifts$`Event Date`)
gender.gifts &lt;- aggregate(gender.vip, by = list(gender.vip$`Participant Gender`, gender.vip$`Event Date`), FUN = mean)
gender.gifts &lt;-gender.gifts[,c(1,2,9)]
colnames(gender.gifts) &lt;- c(&quot;Gender&quot;, &quot;Event Date&quot;, &quot;Gift Amount&quot;)
gender.gifts

gender.gifts$`Event Date` &lt;- as.Date(gender.gifts$`Event Date`)
gender.gif &lt;- aggregate(gender.gifts, by = list(gender.gifts$`Gender`, gender.gifts$`Event Date`), FUN = mean)
gender.gif &lt;-gender.gif[,c(1,2,5)]
colnames(gender.gif) &lt;- c(&quot;Gender&quot;, &quot;Event Date&quot;, &quot;Gift Amount&quot;)</code></pre>
</div>
<div id="mean-donation-for-each-fiscal-year" class="section level1">
<h1>mean donation for each fiscal year</h1>
<pre><code>gender.gifts.year &lt;- aggregate(gender.vip, by = list(gender.vip$`Participant Gender`, gender.vip$`Fiscal Year`), FUN = mean)
gender.gifts.year &lt;-gender.gifts.year[,c(1,2,9)]
colnames(gender.gifts.year) &lt;- c(&quot;Gender&quot;, &quot;Year&quot;, &quot;Gift Amount&quot;)
gender.gifts.year
  
g.gift.year.viz &lt;- ggplot(data = gender.gifts.year, 
                     aes(x = gender.gifts.year$Year, y = gender.gifts.year$`Gift Amount`, fill = gender.gifts.year$Gender)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;)
g.gift.year.viz +
  labs(title = &quot;Mean Participant Donation per Year by Gender&quot;) +
  labs(x = &quot;Fiscal Year&quot;) +
  labs(y = &quot;Gift Amount&quot;)</code></pre>
<pre><code>event.gifts &lt;- aggregate(gender.vip, by = list(gender.vip$`Event Name`, gender.vip$`Fiscal Year`), FUN = mean)
event.gifts &lt;- event.gifts[,c(1,3,9)]
as.data.frame(event.gifts)
colnames(event.gifts) &lt;- c(&quot;Event&quot;, &quot;Date&quot;, &quot;Gift Amount&quot;)

event.gifts$Year &lt;- format(event.gifts$Date, &quot;%Y&quot;)
event.gifts$Month &lt;- format(event.gifts$Date, &quot;%b&quot;)
event.gifts$Day &lt;- format(event.gifts$Date, &quot;%d&quot;)
event.gifts$CommonDate &lt;- as.Date(as.character(as.POSIXct(event.gifts$Date)))

event.viz &lt;- ggplot(data = event.gifts, mapping = aes(x = CommonDate, y = `Gift Amount`, shape = Year, colour = Year)) +
    geom_point() +
    geom_line(aes(group = 1))
event.viz &lt;- event.viz + 
  facet_wrap(~Year, ncol = 1, scales = &quot;free_x&quot;) + theme_bw() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  scale_y_continuous() +
  scale_x_date(labels = date_format(&quot;%d-%b&quot;), breaks = date_breaks(&quot;2 weeks&quot;))
event.viz
</code></pre>
<pre><code>participants.event &lt;- as.data.frame(
  participants %&gt;%
    select(`Member ID`, `Internal Event Name`) %&gt;%
    group_by(`Internal Event Name`) %&gt;%
    tally()
)
participants.event &lt;- arrange(participants.event, desc(n))
participants.event

participants.annual &lt;- as.data.frame(
  participants %&gt;%
    select(`Member ID`, `Fiscal Year`) %&gt;%
    group_by(`Fiscal Year`) %&gt;%
    tally()
)
participants.annual</code></pre>
<pre><code>class(participants)
dim(participants)
glimpse(participants)
head(participants, n = 5)
tail(participants, n = 5)
summary(participants)</code></pre>
<pre><code># acknowledge NA&#39;s 
map(participants, ~sum(is.na(.)))</code></pre>
<pre><code>participants.dt &lt;- data.table(gender.vip)

setkey(participants.dt, `Participant Occupation`, `Total From Participant($)`)

participants.dt[,print(.SD), by = `Participant Occupation`]

#participants.dt &lt;- participants.dt[,.[(-`Total From Participant($)`)],
#                                   by=list(`Participant Occupation`, `Total From #Participant($)`)]

total.occ.gift &lt;- participants.dt[,.(Total.Gift=sum(`Total From Participant($)`)), by = `Participant Occupation`][order(-Total.Gift)]

occ.total &lt;- ggplot(total.occ.gift, aes(x = `Participant Occupation`)) +
  geom_bar(stat = &quot;identity&quot;, aes(y = Total.Gift))
occ.total

avg.occ.gift &lt;- participants.dt[,(Avg.Gift=mean(`Total From Participant($)`)),by=.(`Participant Occupation`)][order(-V1)]

# std.dev for each participant grouped by occupation
setkey(participants.dt, `Participant Occupation`)
participants.dt[&quot;Retail Wholesale&quot;,(Sd.V3=sd(`Total From Participant($)`))]
participants.dt[&quot;Retail Wholesale&quot;,]

# employer
setkey(participants.dt, `Participant Employer`)
participants.dt[,.N, by = `Participant Employer`][order(-N)]
setorder(setDT(participants.dt), -`Participant Employer`)[, head(.SD, 10), keyby][,.N, by = `Participant Employer`]
employer &lt;- ggplot(participants.dt, aes(x = `Participant Employer`)) +
  geom_bar()
employer</code></pre>
</div>
<div id="some-basic-data-viz" class="section level1">
<h1>some basic data viz</h1>
<pre><code>barplot(table(participants$`Participant Occupation`), ylab = &quot;Count&quot;, main = &quot;Occupations of our Participants&quot;,
        ylim = c(0,2500), las = 2, col=rgb(0.2,0.4,0.6,0.6))
occ.count &lt;- table(participants$`Participant Occupation`)
occ.count

occupation.omitNA &lt;- data.table(occupation.omitNA)
setkey(occupation.omitNA, `Participant Occupation`, `Participant Gender`)
occupation.omitNA &lt;- participants[!is.na(participants$`Participant Occupation`),]
occ.count.omit.na &lt;- occupation.omitNA[,.N, by=.(`Participant Occupation`,`Participant Gender`)]
occ.count.omit.na &lt;- occ.count.omit.na[!is.na(`Participant Gender`)][order(-`N`)]
setnames(occ.count.omit.na, old = &quot;V1&quot;, new = &quot;Occupation&quot;)</code></pre>
</div>
<div id="occupation-demographic" class="section level1">
<h1>Occupation Demographic</h1>
<pre><code>top20.occupations.viz &lt;- ggplot(data = occ.count.omit.na, aes(x = occupation.omitNA$`Participant Occupation`)) + 
  geom_bar(na.rm = TRUE, aes(y = (..count..), fill = `Participant Gender`)) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
top20.occupations.viz &lt;- top20.occupations.viz + 
  labs(x = &quot;Occupations&quot;) + 
  labs(title = &quot;Frequency of Participant Occupation&quot;) + 
  labs(y = &quot;Count&quot;)
top20.occupations.viz</code></pre>
</div>
<div id="occupation-demographic-1" class="section level1">
<h1>Occupation Demographic</h1>
<pre><code>top20.occupations.viz &lt;- ggplot(data = occ.count.omit.na, aes(x = reorder(`Participant Occupation`, -`N`), 
                                                              y = `N`, fill = `Participant Gender`)) + 
  geom_bar(stat = &quot;identity&quot;) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
top20.occupations.viz &lt;- top20.occupations.viz + 
  labs(x = &quot;Occupations&quot;) + 
  labs(title = &quot;Frequency of Participant Occupation&quot;) + 
  labs(y = &quot;Count&quot;)
top20.occupations.viz</code></pre>
</div>
<div id="prior-participant-yes---no" class="section level1">
<h1>Prior Participant? Yes - No?</h1>
<pre><code>prior.par.bar &lt;- barplot(table(participants$`Is Prior Participant`), ylab = &quot;Count&quot;, main = &quot;Count of Prior Participants&quot;,
        ylim = c(0,300000), las = 2, col=rgb(0.2,0.4,0.6,0.6))</code></pre>
</div>
<div id="team-division-bar-plot" class="section level1">
<h1>Team division bar plot</h1>
<pre><code>team.division.bar &lt;- barplot(table(participants$`Team Division`), ylab = &quot;Count&quot;, main = &quot;Team Division Demographic&quot;,
        ylim = c(0,30000), las = 2, col=rgb(0.2,0.4,0.6,0.6))</code></pre>
<pre><code>g.year.viz &lt;- ggplot(data = gender.year, 
                     aes(x = Year, y = Count))+
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;)
g.year.viz +
  labs(title = &quot;Annual Participant Count&quot;) +
  labs(x = &quot;Event Year&quot;) +
  labs(y = &quot;Count&quot;)

gt.count &lt;- aggregate(gender.vip$`Participant Gender` ~ gender.vip$`Fiscal Year`, data = gender.vip, FUN = length)
colnames(gt.count) &lt;- c(&quot;Year&quot;, &quot;Count&quot;)
gt.count</code></pre>
<div id="prep-for-voronoi" class="section level3">
<h3>prep for voronoi</h3>
<pre><code>topEvents18 &lt;- read_csv(&quot;C:\\Users\\J-Blazer\\Documents\\ETM 527\\topEvents18.csv&quot;)
cities.proj &lt;- mapproject(topEvents18$Lon, topEvents18$Lat, &quot;albers&quot;, param=c(30,40))
par(mar=c(0,0,0,0))
plot(cities.proj, asp=1, type=&quot;n&quot;, bty=&quot;n&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, axes = FALSE)
points(cities.proj, pch=20, cex=0.1, col=&quot;red&quot;)
topEventsVorn &lt;- deldir(cities.proj$x, cities.proj$y)
plot(topEventsVorn, wlines=&quot;tess&quot;, wpoints=&quot;none&quot;, number=FALSE, add=TRUE, lty=1)</code></pre>
</div>
<div id="can-we-quantify-the-effect-competing-events-are-having-in-our-top-markets" class="section level3">
<h3>Can we quantify the effect competing events are having in our top markets?</h3>
<pre><code>library(dplyr)
library(ggplot2)</code></pre>
<pre><code>Bike_events = readRDS(&quot;D:/527- Data Mining/TUN Data Challenge/Datasets/Bike_Events.rds&quot;)</code></pre>
<pre><code># these are top markets in  terms of active registrations pulled from Bike events
markets = c(&quot;TX&quot;,&quot;PA&quot;,&quot;MN&quot;,&quot;NY&quot;,&quot;MA&quot;,&quot;NC&quot;,&quot;CO&quot;,&quot;OH&quot;,&quot;CA&quot;,&quot;KS&quot;,&quot;MO&quot;,&quot;WA&quot;,&quot;CA&quot;,&quot;IL&quot;,&quot;NJ&quot;)

#retrieving active registrations for top markets
All.events.registrations = Bike_events%&gt;%
  select(Security.Category.Name,Fiscal.Year,State,Active.Registrations)%&gt;%
  group_by(Security.Category.Name,Fiscal.Year,State)%&gt;%
  summarise(sum(Active.Registrations))%&gt;%
  filter(State %in% markets)
write.table(All.events.registrations,&quot;Events.registrations.State.csv&quot;, sep = &quot;,&quot;)</code></pre>
<pre><code>All.events.funds = Bike_events%&gt;%
  select(Security.Category.Name,Fiscal.Year,Total.of.All.Confirmed.Gifts...,Total.Event.Gifts...,Total.From.Participant...,Total.Team.Gifts...,Total.Not.From.Participant...,City,State)%&gt;%
  group_by(Security.Category.Name,Fiscal.Year,State)%&gt;%
   filter(State %in% markets)</code></pre>
<pre><code>All.events.funds$TotalAmount = rowSums(All.events.funds[,3:7])</code></pre>
<pre><code>All.events.funds=All.events.funds%&gt;%
  select(Security.Category.Name,Fiscal.Year,Total.of.All.Confirmed.Gifts...,Total.Event.Gifts...,Total.From.Participant...,Total.Team.Gifts...,Total.Not.From.Participant...,City,State,TotalAmount)%&gt;%
  group_by(Security.Category.Name,Fiscal.Year,State)%&gt;%
  summarise(sum(TotalAmount))</code></pre>
<pre><code>write.table(All.events.funds,&quot;All.events.funds.csv&quot;, sep = &quot;,&quot;)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
